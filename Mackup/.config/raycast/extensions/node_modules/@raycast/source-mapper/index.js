"use strict";var B=Object.create;var y=Object.defineProperty;var Y=Object.getOwnPropertyDescriptor;var G=Object.getOwnPropertyNames;var J=Object.getPrototypeOf,Q=Object.prototype.hasOwnProperty;var v=(n,e)=>()=>(e||n((e={exports:{}}).exports,e),e.exports);var U=(n,e,r,t)=>{if(e&&typeof e=="object"||typeof e=="function")for(let i of G(e))!Q.call(n,i)&&i!==r&&y(n,i,{get:()=>e[i],enumerable:!(t=Y(e,i))||t.enumerable});return n};var h=(n,e,r)=>(r=n!=null?B(J(n)):{},U(e||!n||!n.__esModule?y(r,"default",{value:n,enumerable:!0}):r,n));var k=v((me,T)=>{"use strict";var ne=/[|\\{}()[\]^$+*?.-]/g;T.exports=n=>{if(typeof n!="string")throw new TypeError("Expected a string");return n.replace(ne,"\\$&")}});var L=v((Se,R)=>{"use strict";var re=k(),te=typeof process=="object"&&process&&typeof process.cwd=="function"?process.cwd():".",F=[].concat(require("module").builtinModules,"bootstrap_node","node").map(n=>new RegExp(`(?:\\((?:node:)?${n}(?:\\.js)?:\\d+:\\d+\\)$|^\\s*at (?:node:)?${n}(?:\\.js)?:\\d+:\\d+$)`));F.push(/\((?:node:)?internal\/[^:]+:\d+:\d+\)$/,/\s*at (?:node:)?internal\/[^:]+:\d+:\d+$/,/\/\.node-spawn-wrap-\w+-\w+\/node:\d+:\d+\)?$/);var g=class{constructor(e){e={ignoredPackages:[],...e},"internals"in e||(e.internals=g.nodeInternals()),"cwd"in e||(e.cwd=te),this._cwd=e.cwd.replace(/\\/g,"/"),this._internals=[].concat(e.internals,oe(e.ignoredPackages)),this._wrapCallSite=e.wrapCallSite||!1}static nodeInternals(){return[...F]}clean(e,r=0){r=" ".repeat(r),Array.isArray(e)||(e=e.split(`
`)),!/^\s*at /.test(e[0])&&/^\s*at /.test(e[1])&&(e=e.slice(1));let t=!1,i=null,c=[];return e.forEach(o=>{if(o=o.replace(/\\/g,"/"),this._internals.some(p=>p.test(o)))return;let s=/^\s*at /.test(o);t?o=o.trimEnd().replace(/^(\s+)at /,"$1"):(o=o.trim(),s&&(o=o.slice(3))),o=o.replace(`${this._cwd}/`,""),o&&(s?(i&&(c.push(i),i=null),c.push(o)):(t=!0,i=o))}),c.map(o=>`${r}${o}
`).join("")}captureString(e,r=this.captureString){typeof e=="function"&&(r=e,e=1/0);let{stackTraceLimit:t}=Error;e&&(Error.stackTraceLimit=e);let i={};Error.captureStackTrace(i,r);let{stack:c}=i;return Error.stackTraceLimit=t,this.clean(c)}capture(e,r=this.capture){typeof e=="function"&&(r=e,e=1/0);let{prepareStackTrace:t,stackTraceLimit:i}=Error;Error.prepareStackTrace=(s,p)=>this._wrapCallSite?p.map(this._wrapCallSite):p,e&&(Error.stackTraceLimit=e);let c={};Error.captureStackTrace(c,r);let{stack:o}=c;return Object.assign(Error,{prepareStackTrace:t,stackTraceLimit:i}),o}at(e=this.at){let[r]=this.capture(1,e);if(!r)return{};let t={line:r.getLineNumber(),column:r.getColumnNumber()};A(t,r.getFileName(),this._cwd),r.isConstructor()&&Object.defineProperty(t,"constructor",{value:!0,configurable:!0}),r.isEval()&&(t.evalOrigin=r.getEvalOrigin()),r.isNative()&&(t.native=!0);let i;try{i=r.getTypeName()}catch{}i&&i!=="Object"&&i!=="[object Object]"&&(t.type=i);let c=r.getFunctionName();c&&(t.function=c);let o=r.getMethodName();return o&&c!==o&&(t.method=o),t}parseLine(e){let r=e&&e.match(ie);if(!r)return null;let t=r[1]==="new",i=r[2],c=r[3],o=r[4],s=Number(r[5]),p=Number(r[6]),u=r[7],x=r[8],M=r[9],P=r[10]==="native",I=r[11]===")",S,a={};if(x&&(a.line=Number(x)),M&&(a.column=Number(M)),I&&u){let f=0;for(let l=u.length-1;l>0;l--)if(u.charAt(l)===")")f++;else if(u.charAt(l)==="("&&u.charAt(l-1)===" "&&(f--,f===-1&&u.charAt(l-1)===" ")){let q=u.slice(0,l-1);u=u.slice(l+1),i+=` (${q}`;break}}if(i){let f=i.match(ce);f&&(i=f[1],S=f[2])}return A(a,u,this._cwd),t&&Object.defineProperty(a,"constructor",{value:!0,configurable:!0}),c&&(a.evalOrigin=c,a.evalLine=s,a.evalColumn=p,a.evalFile=o&&o.replace(/\\/g,"/")),P&&(a.native=!0),i&&(a.function=i),S&&i!==S&&(a.method=S),a}};function A(n,e,r){e&&(e=e.replace(/\\/g,"/"),e.startsWith(`${r}/`)&&(e=e.slice(r.length+1)),n.file=e)}function oe(n){if(n.length===0)return[];let e=n.map(r=>re(r));return new RegExp(`[/\\\\]node_modules[/\\\\](?:${e.join("|")})[/\\\\][^:]+:\\d+:\\d+`)}var ie=new RegExp("^(?:\\s*at )?(?:(new) )?(?:(.*?) \\()?(?:eval at ([^ ]+) \\((.+?):(\\d+):(\\d+)\\), )?(?:(.+?):(\\d+):(\\d+)|(native))(\\)?)$"),ce=/^(.*?) \[as (.*?)\]$/;R.exports=g});var m=require("worker_threads");var d=h(require("node:fs")),w=h(require("node:path")),O=h(require("@parcel/source-map"));var b;if(process.env.RAYCAST_OS_LOG!==void 0){let{NapiOsLog:n}=require("@raycast/napi");b=new n(process.env.RAYCAST_BUNDLE_ID,"node")}else b={log:(n,e)=>{}};function $(n,e){b.log(n,e)}function _(n){$(1,n)}function C(n){$(16,n)}var j=require("node:worker_threads"),V=/data:application\/json[^,]+base64,/,W=[/^node:/],z=1;function N(n,e){if(j.isMainThread?C("Performing source mapping in main thread"):_("Performing source mapping in worker thread"),!e)return{message:n,stack:e};let r=new Map,t=0,i=e.map(o=>{if(t>=z||!o.file)return o;try{let s=r.get(o.file)??X(o.file);return s?(r.set(o.file,s),K(o,s,t===0)):o}catch{}finally{t+=1}return o}),c=e[0];return!c||typeof c.file>"u"||typeof n>"u"?{message:n,stack:i}:{message:H(n,c,r.get(c.file)),stack:i}}function H(n,e,r){let t=/^(?!\bundefined\b)\b(\w+)\b is not a function$/;if(!r||typeof e.line>"u"||typeof e.column>"u"||!t.test(n))return n;let{line:i,column:c}=e,o=r.findClosestMapping(i,c);return o?.name?n.replace(/^\b(\w+)\b/,o.name):n}function K(n,e,r){if(!n.file||!n.line||!n.column)return n;let t=e.findClosestMapping(n.line,n.column);return t?{raw:n.raw,file:w.default.resolve(w.default.dirname(n.file),t.source??""),fileContent:r&&t.source?e.getSourceContent(t.source):void 0,line:t.original?.line,column:t.original?.column,function:n.function}:n}function X(n){if(W.some(i=>i.test(n)))return null;let e=Z(n)??ee(n);if(!e)return null;let r=JSON.parse(e),t=new O.default;return t.addVLQMap(r),t}function Z(n){if(!d.default.existsSync(n))return null;let e=d.default.readFileSync(n).toString("utf8");if(!V.test(e))return null;let r=e.slice(e.lastIndexOf(",")+1);return Buffer.from(r,"base64").toString("utf8")}function ee(n){let e=`${n}.map`;return d.default.existsSync(e)?d.default.readFileSync(e).toString("utf8"):null}var E=h(L()),ae=[/server\/index.js$/,/^node:internal\/process\/task_queues/],se=5,ue=new E.default({internals:E.default.nodeInternals()});function D(n){return n.split(`
`).slice(1,se).map(r=>{let t=ue.parseLine(r);return{raw:r,file:t?.file,line:t?.line,column:t?.column,function:t?.function}}).filter(r=>!ae.some(t=>t.test(r.file??"")))}m.parentPort?.postMessage(N(m.workerData?.message,D(m.workerData?.stack)));
